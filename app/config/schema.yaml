models:
  - class_name: Users
    table_name: m_users
    description: 実在する利用者（人）を一意に管理するテーブル
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: user_uuid
        type: String
        args: [36]
        nullable: false
        unique: true
        default: uuid.uuid4
        comment: ユーザーUUID

      - name: user_name
        type: String
        args: [50]
        nullable: false
        comment: 氏名

      - name: hashed_password
        type: String
        args: [255]
        nullable: false
        comment: ハッシュ化されたパスワード

      - name: is_active
        type: Boolean
        nullable: false
        default: true
        comment: 利用可能フラグ（無効化対応）

      - name: last_login_at
        type: TIMESTAMP
        nullable: true
        comment: 最終ログイン日時

      - name: create_date
        type: TIMESTAMP
        nullable: false
        default: datetime.now
        comment: 作成日時

      - name: create_user_uuid
        type: String
        args: [10]
        nullable: false
        comment: 作成者ユーザーコード

      - name: update_date
        type: TIMESTAMP
        nullable: false
        default: datetime.now
        onupdate: datetime.now
        comment: 更新日時

      - name: update_user_uuid
        type: String
        args: [10]
        nullable: false
        comment: 更新者ユーザーコード

      - name: update_count
        type: Integer
        nullable: false
        default: 0
        comment: 更新回数

  - class_name: Tenants
    table_name: m_tenants
    description: |
      会社ごとのテナント情報
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        unique: true
        nullable: false
        default: uuid.uuid4
        comment: テナントUUID
      - name: create_date
        type: TIMESTAMP
        nullable: false
        default: datetime.now
        comment: 作成日時
      - name: create_user_uuid
        type: String
        args: [10]
        nullable: false
        comment: 作成者ユーザーコード
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
        comment: 更新日時
      - name: update_user_uuid
        type: String
        args: [10]
        nullable: false
        comment: 更新者ユーザーコード
      - name: update_count
        type: Integer
        nullable: false
        comment: 更新回数

  - class_name: Employee
    table_name: employees
    description: |
      会社ごとにどのユーザーが所属しているか管理
      同じユーザーが再入社した場合は新しいレコードを追加し、履歴を保持する
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: user_uuid
        type: String
        args: [36]
        nullable: false
        comment: ユーザーUUID
      - name: belong_start_date
        type: Date
        nullable: false
        comment: 所属開始日
      - name: belong_end_date
        type: Date
        nullable: true
        comment: 所属終了日（現役中はNULL）
      - name: create_date
        type: TIMESTAMP
        nullable: false
        default: datetime.now
        comment: 作成日時
      - name: create_user_uuid
        type: String
        args: [10]
        nullable: false
        comment: 作成者ユーザーコード
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
        comment: 更新日時
      - name: update_user_uuid
        type: String
        args: [10]
        nullable: false
        comment: 更新者ユーザーコード
      - name: update_count
        type: Integer
        nullable: false
        comment: 更新回数

    constraints:
      - type: foreign_key
        columns: [user_uuid]
        references:
          table: m_users
          columns: [user_uuid]
      - type: foreign_key
        columns: [tenant_uuid]
        references:
          table: m_tenants
          columns: [tenant_uuid]
      - type: unique
        columns: [tenant_uuid, user_uuid, belong_start_date]

  - class_name: Group
    table_name: m_group
    description: 部署マスタ
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID

      - name: group_code
        type: String
        args: [10]
        nullable: false
        comment: 部署コード

      - name: group_name
        type: String
        args: [50]
        nullable: false
        comment: 部署名

      - name: term_from
        type: Date
        nullable: false
        comment: 有効開始日

      - name: term_to
        type: Date
        nullable: true
        comment: 有効終了日

      - name: upper_group_code
        type: String
        args: [10]
        nullable: true
        foreign_key:
          reference: m_group.group_code
          onupdate: CASCADE
          ondelete: SET NULL
        comment: 上位部署コード

      - name: permission_range
        type: EnumType
        args: [enum_class=PermissionRange]
        nullable: false
        comment: 利用権限範囲

      - name: create_date
        type: TIMESTAMP
        default: "lambda: datetime.now()"
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: "lambda: datetime.now()"
        onupdate: "lambda: datetime.now()"
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, group_code]
    foreign_keys:
      - columns: [tenant_uuid]
        references: [m_tenants.tenant_uuid]

  - class_name: EmployeeGroup
    table_name: m_employee_group
    description: 従業員部署マスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID

      - name: user_uuid
        type: String
        args: [36]
        nullable: false
        comment: ユーザーUUID

      - name: group_code
        type: String
        args: [10]
        nullable: false
        comment: 部署コード

      - name: default_group_code
        type: EnumType
        args: [enum_class=DefaultGroupFlg]
        nullable: true
        comment: 規定部署コード

      - name: term_from
        type: Date
        nullable: false
        comment: 有効開始日

      - name: term_to
        type: Date
        nullable: true
        comment: 有効終了日

      - name: range
        type: EnumType
        args: [enum_class=Range]
        nullable: false
        comment: 利用権限範囲

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid, user_uuid, group_code]
      - [tenant_uuid]
      - [user_uuid]
      - [group_code]

    uniques:
      - [tenant_uuid, user_uuid, group_code]

    foreign_keys:
      - columns: [tenant_uuid]
        references: [m_tenants.tenant_uuid]

      - columns: [tenant_uuid, user_uuid]
        references: [employees.tenant_uuid, employees.user_uuid]

  - class_name: Boss
    table_name: m_boss
    description: 上司マスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID

      - name: user_uuid
        type: String
        args: [36]
        nullable: false
        comment: ユーザーUUID

      - name: group_code
        type: String
        args: [10]
        nullable: true
        comment: 部署コード

      - name: application_form_code
        type: String
        args: [10]
        nullable: true
        comment: 申請書コード

      - name: boss_tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: 直属上司のテナントUUID

      - name: boss_group_code
        type: String
        args: [10]
        nullable: false
        comment: 直属上司の部署コード

      - name: boss_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 直属上司のユーザーUUID

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid, group_code, user_uuid, application_form_code]
      - [tenant_uuid]

    uniques:
      - [tenant_uuid, group_code, user_uuid, application_form_code]

    foreign_keys:
      - columns: [tenant_uuid, user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]

  - class_name: DeputyApprovel
    table_name: m_deputy_approvel
    description: 代理承認者マスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        foreign_key: m_tenants.tenant_uuid
        comment: テナントUUID

      - name: group_code
        type: String
        args: [10]
        nullable: false
        comment: 部署コード

      - name: user_uuid
        type: String
        args: [36]
        nullable: false
        comment: ユーザーUUID

      - name: deputy_approverl_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 代理承認者のテナントUUID

      - name: deputy_approverl_group_code
        type: String
        args: [10]
        nullable: false
        comment: 代理承認者の部署コード

      - name: deputy_approverl_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 代理承認者のユーザーUUID

      - name: deputy_contents
        type: String
        args: [255]
        nullable: false
        comment: 依頼理由

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, group_code, user_uuid]
    foreign_keys:
      - columns: [tenant_uuid, user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]

  - class_name: ApplicationClassificationFormat
    table_name: m_application_classification_format
    description: 規定申請分類マスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: application_classification_code
        type: String
        args: [10]
        nullable: false
        unique: true
        comment: 申請分類コード
      - name: application_classification_name
        type: String
        args: [30]
        nullable: false
        comment: 申請分類名
      - name: sort_number
        type: Integer
        nullable: false
        comment: ソート順
      - name: create_date
        type: TIMESTAMP
        nullable: false
        default: datetime.now
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        nullable: false
        default: datetime.now
        onupdate: datetime.now
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false

  - class_name: ApplicationFormFormat
    table_name: m_application_form_format
    description: 規定申請書マスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: application_form_code
        type: String
        args: [10]
        nullable: false
        comment: 申請書コード
      - name: application_form_name
        type: String
        args: [30]
        nullable: false
        comment: 申請書名
      - name: application_classification_code
        type: String
        args: [10]
        nullable: false
        foreign_key: m_application_classification_format.application_classification_code
        comment: 申請分類コード
      - name: skip_apply_employee
        type: Boolean
        nullable: false
        comment: 申請者を承認から外す判定
      - name: auto_approverl_flag
        type: EnumType
        args: [enum_class=AutoApproverlFlag]
        nullable: false
        comment: 自動承認フラグ
      - name: pulling_flag
        type: EnumType
        args: [enum_class=PullingFlag]
        nullable: false
        comment: 引き戻し区分
      - name: withdrawal_flag
        type: EnumType
        args: [enum_class=WithdrawalFlag]
        nullable: false
        comment: 取り下げ区分
      - name: route_flag
        type: EnumType
        args: [enum_class=RouteFlag]
        nullable: false
        comment: 直接部門の扱い
      - name: sort_number
        type: Integer
        nullable: false
        comment: ソート順
      - name: table_name
        type: String
        args: [50]
        nullable: false
        unique: true
        comment: テーブル名
      - name: screen_code
        type: String
        args: [6]
        nullable: false
        comment: 画面コード
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false

  - class_name: ApplicationForm
    table_name: m_application_form
    description: 申請書マスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: application_form_code
        type: String
        args: [10]
        nullable: false
        comment: 申請書コード
      - name: application_form_name
        type: String
        args: [30]
        nullable: false
        comment: 申請書名
      - name: application_classification_code
        type: String
        args: [10]
        nullable: false
        foreign_key: m_application_classification.application_classification_code
        comment: 申請分類コード
      - name: skip_apply_employee
        type: Boolean
        nullable: false
        comment: 申請者を承認から外す判定
      - name: auto_approverl_flag
        type: EnumType
        args: [enum_class=AutoApproverlFlag]
        nullable: false
        comment: 自動承認フラグ
      - name: pulling_flag
        type: EnumType
        args: [enum_class=PullingFlag]
        nullable: false
        comment: 引き戻し区分
      - name: withdrawal_flag
        type: EnumType
        args: [enum_class=WithdrawalFlag]
        nullable: false
        comment: 取り下げ区分
      - name: route_flag
        type: EnumType
        args: [enum_class=RouteFlag]
        nullable: false
        comment: 直接部門の扱い
      - name: sort_number
        type: Integer
        nullable: false
        comment: ソート順
      - name: executed_after_approverl
        type: String
        args: [255]
        nullable: true
        comment: 承認後に実行するタスク
      - name: table_name
        type: String
        args: [50]
        nullable: false
        comment: テーブル名
      - name: screen_code
        type: String
        args: [6]
        nullable: false
        comment: 画面コード
      - name: job_title_code
        type: String
        args: [10]
        nullable: true
        comment: 役職コード
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false
    indexes:
      - [tenant_uuid]
      - [application_form_code]
    uniques:
      - [tenant_uuid, application_form_code]
      - [tenant_uuid, application_form_name]
      - [tenant_uuid, table_name]

  - class_name: ApplicationFormRoute
    table_name: m_application_form_route
    description: 申請書別ルートマスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: application_form_code
        type: String
        args: [10]
        nullable: false
        comment: 申請書コード
      - name: group_code
        type: String
        args: [10]
        nullable: true
        comment: 部署コード
      - name: individual_route_code
        type: String
        args: [10]
        nullable: true
        comment: 直接部門
      - name: common_route_code
        type: String
        args: [10]
        nullable: true
        comment: 間接部門
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false
    indexes:
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, application_form_code, group_code]

  - class_name: IndividualRoute
    table_name: m_individual_route
    description: 直接ルートマスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: individual_route_code
        type: String
        args: [10]
        nullable: false
        comment: 直接部門
      - name: individual_route_name
        type: String
        args: [30]
        nullable: false
        comment: 直接部門名
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false
    indexes:
      - [tenant_uuid, individual_route_code]
      - [tenant_uuid]  # ← これだけでOK！
    uniques:
      - [tenant_uuid, individual_route_code]
      - [tenant_uuid, individual_route_name]

  - class_name: IndividualActivity
    table_name: m_individual_activity
    description: 直接ルートアクティビティマスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: individual_route_code
        type: String
        args: [10]
        nullable: false
        comment: 直接部門コード
      - name: activity_code
        type: Integer
        nullable: false
        comment: アクティビティコード
      - name: approverl_ctenant_uuid
        type: String
        args: [10]
        nullable: true
        comment: 承認者のテナントUUID
      - name: approverl_role_code
        type: String
        args: [30]
        nullable: true
        comment: 承認者の利用権限コード
      - name: approverl_group_code
        type: String
        args: [10]
        nullable: true
        comment: 承認者の部署コード
      - name: approverl_user_uuid
        type: String
        args: [10]
        nullable: true
        comment: 承認者のユーザーUUID
      - name: function
        type: EnumType
        args: [enum_class=ApprovalFunction]
        nullable: false
        comment: 承認画面の機能

      - name: is_terminal
        type: Boolean
        default: false
        nullable: false
        comment: このアクティビティが終了ノードならTrue

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false
    indexes:
      - [tenant_uuid, individual_route_code]
      - [tenant_uuid, approverl_role_code]
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, individual_route_code, activity_code]
    foreign_keys:
      - columns: [tenant_uuid, individual_route_code]
        references: [m_individual_route.tenant_uuid, m_individual_route.individual_route_code]

  - class_name: CommonRoute
    table_name: m_common_route
    description: 間接ルートマスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: common_route_code
        type: String
        args: [10]
        nullable: false
        comment: 間接部門
      - name: common_route_name
        type: String
        args: [30]
        nullable: false
        comment: 間接部門名
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false
    indexes:
      - [tenant_uuid, common_route_code]
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, common_route_code]
      - [tenant_uuid, common_route_name]
    foreign_keys:
      - columns: [tenant_uuid, common_route_code]
        references: [m_common_route.tenant_uuid, m_common_route.common_route_code]

  - class_name: CommonActivity
    table_name: m_common_activity
    description: 間接ルートアクティビティマスタ
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー
      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: テナントUUID
      - name: common_route_code
        type: String
        args: [10]
        nullable: false
        comment: 間接部門コード
      - name: activity_code
        type: Integer
        nullable: false
        comment: アクティビティコード
      - name: approverl_tenant_uuid
        type: String
        args: [10]
        nullable: true
        comment: 承認者のテナントUUID
      - name: approverl_role_code
        type: String
        args: [30]
        nullable: true
        comment: 承認者の利用権限コード
      - name: approverl_group_code
        type: String
        args: [10]
        nullable: true
        comment: 承認者の部署コード
      - name: approverl_user_uuid
        type: String
        args: [10]
        nullable: true
        comment: 承認者のユーザーUUID
      - name: function
        type: EnumType
        args: [enum_class=ApprovalFunction]
        nullable: false
        comment: 承認画面の機能
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false
      - name: create_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false
      - name: update_employee_code
        type: String
        args: [10]
        nullable: false
      - name: update_count
        type: Integer
        nullable: false
    indexes:
      - [tenant_uuid, common_route_code, activity_code]
      - [tenant_uuid, common_route_code]
      - [tenant_uuid, approverl_role_code]
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, common_route_code, activity_code]
    foreign_keys:
      - columns: [tenant_uuid, common_route_code]
        references: [m_common_route.tenant_uuid, m_common_route.common_route_code]

  - class_name: ApplicationObject
    table_name: t_application_object
    description: 申請オブジェクト（申請全体の状態・多重インスタンス/マイルストーン/キャンセル等も管理）
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        foreign_key: m_tenants.tenant_uuid
        comment: テナントUUID

      - name: application_number
        type: Integer
        nullable: false
        comment: 申請番号

      - name: application_form_code
        type: String
        args: [10]
        nullable: false
        comment: 申請書コード

      - name: target_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 対象者のテナントUUID

      - name: target_group_code
        type: String
        args: [10]
        nullable: false
        comment: 対象者の部署コード

      - name: target_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 対象者のユーザーUUID

      - name: applicant_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 申請者のテナントUUID

      - name: applicant_group_code
        type: String
        args: [10]
        nullable: false
        comment: 申請者の部署コード

      - name: applicant_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 申請者のユーザーUUID

      - name: apply_date
        type: TIMESTAMP
        nullable: false
        comment: 申請日

      - name: approval_date
        type: TIMESTAMP
        nullable: true
        comment: 承認日

      - name: application_status
        type: EnumType
        args: [enum_class=ApplicationStatus]
        nullable: false
        comment: 申請書状態

      # --- WF全体拡張項目 ---
      - name: is_case_canceled
        type: Boolean
        default: false
        nullable: false
        comment: ケース全体（申請全体）がキャンセルされた場合True

      - name: case_cancel_reason
        type: String
        args: [255]
        nullable: true
        comment: ケースキャンセル理由

      - name: case_canceled_by
        type: String
        args: [36]
        nullable: true
        comment: キャンセル操作ユーザーUUID

      - name: total_instance_count
        type: Integer
        nullable: true
        comment: 多重インスタンスの総数（全体制御用）

      - name: milestone_count
        type: Integer
        nullable: true
        comment: マイルストーンの合計数

      - name: reached_milestone_count
        type: Integer
        nullable: true
        comment: 到達済みマイルストーン数

      # --- 基本・監査項目 ---
      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, application_number]
    foreign_keys:
      - columns: [tenant_uuid, applicant_user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]
      - columns: [tenant_uuid, target_user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]

  - class_name: ActivityObject
    table_name: t_activity_object
    description: 申請明細オブジェクト（全WFパターン対応・全状態管理フラグ入り）
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        foreign_key: m_tenants.tenant_uuid
        comment: テナントUUID

      - name: application_number
        type: Integer
        nullable: false
        comment: 申請番号

      - name: route_type
        type: Integer
        nullable: false
        comment: ルートタイプ

      - name: route_number
        type: Integer
        nullable: false
        comment: ルートナンバー

      - name: group_key
        type: String
        args: [20]
        nullable: true
        comment: 分岐グループ識別子

      - name: approverl_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 承認者のテナントUUID

      - name: approverl_role_code
        type: String
        args: [30]
        nullable: true
        comment: 承認者の利用権限コード

      - name: approverl_group_code
        type: String
        args: [10]
        nullable: true
        comment: 承認者の部署コード

      - name: approverl_user_uuid
        type: String
        args: [36]
        nullable: true
        comment: 承認者のユーザーUUID

      - name: function
        type: EnumType
        args: [enum_class=ApprovalFunction]
        nullable: false
        comment: 承認画面の機能

      # --- 多重インスタンス／ループ制御 ---
      - name: instance_group_id
        type: String
        nullable: true
        comment: 多重インスタンスグループID

      - name: instance_index
        type: Integer
        nullable: true
        comment: インスタンス内の番号

      - name: total_instance_count
        type: Integer
        nullable: true
        comment: インスタンスグループ全体の数（Activity単位で必要な場合）

      - name: loop_count
        type: Integer
        default: 0
        nullable: false
        comment: ループ通過回数

      - name: max_loop
        type: Integer
        nullable: true
        comment: ループ最大回数

      - name: parent_activity_id
        type: Integer
        nullable: true
        comment: 再帰元アクティビティID

      - name: is_synchronized
        type: Boolean
        default: false
        nullable: false
        comment: 同期必須ならTrue

      # --- 排他進行系（交互並列など） ---
      - name: is_interleaved_locked
        type: Boolean
        default: false
        nullable: false
        comment: 並列経路で他が実行中ならTrue

      # --- マイルストーン系 ---
      - name: is_milestone
        type: Boolean
        default: false
        nullable: false
        comment: マイルストーンならTrue

      - name: is_milestone_reached
        type: Boolean
        default: false
        nullable: false
        comment: マイルストーン到達済み

      # --- キャンセル・終了・制御 ---
      - name: is_canceled
        type: Boolean
        default: false
        nullable: false
        comment: アクティビティがキャンセル済みならTrue

      - name: cancel_reason
        type: String
        args: [255]
        nullable: true
        comment: キャンセル理由

      - name: canceled_by
        type: String
        args: [36]
        nullable: true
        comment: キャンセル操作ユーザーUUID

      - name: is_terminal
        type: Boolean
        default: false
        nullable: false
        comment: 終了ノードならTrue

      # --- Discriminator, Deferred Choice等 ---
      - name: is_discriminator_loser
        type: Boolean
        default: false
        nullable: false
        comment: Discriminator合流時に負けた経路ならTrue

      - name: is_deferred_choice_winner
        type: Boolean
        default: false
        nullable: false
        comment: Deferred Choiceで勝者ならTrue

      - name: is_deferred_choice_loser
        type: Boolean
        default: false
        nullable: false
        comment: Deferred Choiceで敗者ならTrue

      # --- トリガー・イベント ---
      - name: trigger_type
        type: String
        args: [50]
        nullable: true
        comment: トリガー種別（イベント名や条件式）

      - name: is_triggered
        type: Boolean
        default: false
        nullable: false
        comment: トリガー発生済み

      - name: triggered_at
        type: TIMESTAMP
        nullable: true
        comment: トリガー発生日時

      # --- 基本・監査項目 ---
      - name: reaching_date
        type: TIMESTAMP
        nullable: true
        comment: 到達日

      - name: process_date
        type: TIMESTAMP
        nullable: true
        comment: 処理日

      - name: activity_status
        type: EnumType
        args: [enum_class=ActivityStatus]
        nullable: true
        comment: 承認者状態

      - name: approverl_comment
        type: String
        args: [255]
        nullable: true
        comment: 承認者のコメント

      - name: is_completed
        type: Boolean
        default: false
        nullable: false
        comment: アクティビティの完了状態

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid, application_number]
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, application_number, route_type, route_number, approverl_tenant_uuid, approverl_group_code, approverl_user_uuid]
    foreign_keys:
      - columns: [tenant_uuid, approverl_user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]
      - columns: [tenant_uuid, deputy_approverl_user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]

  - class_name: Appended
    table_name: t_appended
    description: 添付オブジェクト
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        foreign_key: m_tenants.tenant_uuid
        comment: テナントUUID

      - name: application_number
        type: Integer
        nullable: false
        comment: 申請番号

      - name: route_type
        type: Integer
        nullable: false
        comment: ルートタイプ

      - name: route_number
        type: Integer
        nullable: false
        comment: ルートナンバー

      - name: group_key
        type: String
        args: [20]
        nullable: true
        comment: 分岐グループ識別子

      - name: approverl_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 承認者のテナントUUID

      - name: approverl_group_code
        type: String
        args: [10]
        nullable: false
        comment: 承認者の部署コード

      - name: approverl_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 承認者のユーザーUUID

      - name: append_title
        type: String
        args: [255]
        nullable: false
        comment: 添付ファイルの説明

      - name: append_path
        type: String
        args: [255]
        nullable: false
        comment: 添付ファイルのパス

      - name: append_date
        type: TIMESTAMP
        nullable: false
        comment: 添付ファイルの登録日

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

    indexes:
      - [tenant_uuid, application_number]
      - [tenant_uuid]
    uniques:
      - [tenant_uuid, application_number, route_type, route_number]
    foreign_keys:
      - columns: [tenant_uuid, approverl_user_uuid]
        references: [m_employee.tenant_uuid, m_employee.user_uuid]

  - class_name: RouteHistory
    table_name: t_route_history
    description: 申請書履歴オブジェクト
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        foreign_key: m_tenants.tenant_uuid
        comment: テナントUUID

      - name: group_key
        type: String
        args: [20]
        nullable: true
        comment: 分岐グループ識別子

      - name: company_name
        type: String
        args: [50]
        nullable: false
        comment: 会社名

      - name: application_number
        type: Integer
        nullable: false
        comment: 申請番号

      - name: re_application_number
        type: Integer
        nullable: true
        comment: 旧申請番号

      - name: application_form_code
        type: String
        args: [10]
        nullable: false
        comment: 申請書コード

      - name: application_form_name
        type: String
        args: [30]
        nullable: false
        comment: 申請書名

      - name: target_tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: 対象者のテナントUUID

      - name: target_company_name
        type: String
        args: [50]
        nullable: false
        comment: 対象者の会社名

      - name: target_group_code
        type: String
        args: [10]
        nullable: false
        comment: 対象者の部署コード

      - name: target_group_name
        type: String
        args: [50]
        nullable: false
        comment: 対象者の部署名

      - name: target_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 対象者のユーザーUUID

      - name: target_employee_name
        type: String
        args: [30]
        nullable: false
        comment: 対象者の氏名

      - name: applicant_tenant_uuid
        type: String
        args: [36]
        nullable: false
        comment: 申請者のテナントUUID

      - name: applicant_company_name
        type: String
        args: [50]
        nullable: false
        comment: 申請者の会社名

      - name: applicant_group_code
        type: String
        args: [10]
        nullable: false
        comment: 申請者の部署コード

      - name: applicant_group_name
        type: String
        args: [50]
        nullable: false
        comment: 申請者の部署名

      - name: applicant_user_uuid
        type: String
        args: [36]
        nullable: false
        comment: 申請者のユーザーUUID

      - name: applicant_employee_name
        type: String
        args: [30]
        nullable: false
        comment: 申請者の氏名

      - name: apply_date
        type: TIMESTAMP
        nullable: false
        comment: 申請日

      - name: approval_date
        type: TIMESTAMP
        nullable: true
        comment: 承認日

      - name: application_status
        type: EnumType
        args: [enum_class=ApplicationStatus]
        nullable: false
        comment: 申請書状態

      - name: applicant_status
        type: EnumType
        args: [enum_class=ApplicantStatus]
        nullable: true
        comment: 申請者状態

      - name: route_type
        type: Integer
        nullable: true
        comment: ルートタイプ

      - name: route_number
        type: Integer
        nullable: true
        comment: ルートナンバー

      - name: approverl_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 承認者のテナントUUID

      - name: approverl_company_name
        type: String
        args: [50]
        nullable: true
        comment: 承認者の会社名

      - name: approverl_role_code
        type: String
        args: [30]
        nullable: true
        comment: 承認者の利用権限コード

      - name: approverl_role_name
        type: String
        args: [30]
        nullable: true
        comment: 承認者の利用権限名

      - name: approverl_group_code
        type: String
        args: [10]
        nullable: true
        comment: 承認者の部署コード

      - name: approverl_group_name
        type: String
        args: [50]
        nullable: true
        comment: 承認者の部署名

      - name: approverl_user_uuid
        type: String
        args: [36]
        nullable: true
        comment: 承認者のユーザーUUID

      - name: approverl_employee_name
        type: String
        args: [30]
        nullable: true
        comment: 承認者氏名

      - name: deputy_approverl_tenant_uuid
        type: String
        args: [36]
        nullable: true
        comment: 代理承認者のテナントUUID

      - name: deputy_approverl_company_name
        type: String
        args: [50]
        nullable: true
        comment: 代理承認者の会社名

      - name: deputy_approverl_group_code
        type: String
        args: [10]
        nullable: true
        comment: 代理承認者の部署コード

      - name: deputy_approverl_group_name
        type: String
        args: [50]
        nullable: true
        comment: 代理承認者の部署名

      - name: deputy_approverl_user_uuid
        type: String
        args: [36]
        nullable: true
        comment: 代理承認者のユーザーUUID

      - name: deputy_approverl_employee_name
        type: String
        args: [30]
        nullable: true
        comment: 代理承認者氏名

      - name: deputy_contents
        type: String
        args: [255]
        nullable: true
        comment: 依頼理由

      - name: function
        type: EnumType
        args: [enum_class=ApprovalFunction]
        nullable: true
        comment: 承認画面の機能

      - name: reaching_date
        type: TIMESTAMP
        nullable: true
        comment: 到達日

      - name: process_date
        type: TIMESTAMP
        nullable: true
        comment: 処理日

      - name: activity_status
        type: EnumType
        args: [enum_class=ActivityStatus]
        nullable: true
        comment: 承認者状態

      - name: approverl_comment
        type: String
        args: [255]
        nullable: true
        comment: 承認者のコメント

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false

  - class_name: ActivityTransit
    table_name: t_activity_transit
    description: アクティビティ遷移定義（AND/OR/条件分岐）
    mapper_args:
      version_id_col: update_count
    columns:
      - name: id
        type: Integer
        primary_key: true
        autoincrement: true
        comment: サロゲートキー

      - name: tenant_uuid
        type: String
        args: [36]
        nullable: false
        foreign_key: m_tenants.tenant_uuid
        comment: テナントUUID

      - name: application_number
        type: Integer
        nullable: false
        comment: 対象申請番号

      - name: from_route_type
        type: Integer
        nullable: false
        comment: 遷移元ルートタイプ

      - name: from_route_number
        type: Integer
        nullable: false
        comment: 遷移元ルートナンバー

      - name: to_route_type
        type: Integer
        nullable: false
        comment: 遷移先ルートタイプ

      - name: to_route_number
        type: Integer
        nullable: false
        comment: 遷移先ルートナンバー

      - name: transition_type
        type: EnumType
        args: [enum_class=TransitionType]
        nullable: false
        comment: 遷移タイプ（AND/OR/CONDITION）

      - name: group_key
        type: String
        args: [20]
        nullable: true
        comment: 分岐グループキー

      - name: condition_expression
        type: String
        args: [255]
        nullable: true
        comment: 条件式（JSONやDSL）

      - name: approval_condition_type
        type: EnumType
        args: [enum_class=ApprovalConditionType]
        nullable: false
        default: "ALL"
        comment: 承認完了条件の種別（ALL=全員, MAJORITY=過半数, ANY=誰か1人）

      - name: approval_threshold
        type: Integer
        nullable: true
        comment: 任意人数承認で可とする場合の閾値（approval_condition_type='THRESHOLD'時）

      - name: sort_number
        type: Integer
        nullable: true
        comment: 並び順

      - name: create_date
        type: TIMESTAMP
        default: datetime.now
        nullable: false

      - name: create_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_date
        type: TIMESTAMP
        default: datetime.now
        onupdate: datetime.now
        nullable: false

      - name: update_employee_code
        type: String
        args: [10]
        nullable: false

      - name: update_count
        type: Integer
        nullable: false
