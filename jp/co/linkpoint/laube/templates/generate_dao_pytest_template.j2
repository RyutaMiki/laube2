import pytest
from sqlalchemy.orm import Session
from jp.co.linkpoint.laube.daos.base.models import {{ model_class }}
from jp.co.linkpoint.laube.daos.{{ model_lower }}_dao import {{ dao_class_name }}

@pytest.fixture
def {{ model_lower }}_dict():
    return {
        {%- for col in columns %}
        "{{ col.name }}": {{ col.example }},
        {%- endfor %}
    }

def test_create_and_get_{{ model_lower }}(db_session: Session, {{ model_lower }}_dict):
    dao = {{ dao_class_name }}()
    obj = dao.create(db_session, {{ model_lower }}_dict)
    found = dao.get(db_session, obj.id)
    assert found is not None

def test_update_{{ model_lower }}(db_session: Session, {{ model_lower }}_dict):
    dao = {{ dao_class_name }}()
    obj = dao.create(db_session, {{ model_lower }}_dict)
    dao.update(db_session, obj.id, {"{{ update_col }}": "updated"})
    updated = dao.get(db_session, obj.id)
    assert updated.{{ update_col }} == "updated"

def test_delete_{{ model_lower }}(db_session: Session, {{ model_lower }}_dict):
    dao = {{ dao_class_name }}()
    obj = dao.create(db_session, {{ model_lower }}_dict)
    dao.delete(db_session, obj.id)
    deleted = dao.get(db_session, obj.id)
    assert deleted is None
